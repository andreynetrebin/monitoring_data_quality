# Документация по проекту мониторинга качества данных состояния лицевых счетов

## Введение
Проект мониторинга качества данных состояния лицевых счетов направлен на обеспечение целостности и актуальности данных между мастер-системой и исторической системой. В рамках проекта реализованы следующие этапы, которые позволяют извлекать, загружать и проверять данные о лицевых счетах.

## Структура проекта
```
monitoring_data_quality/
│
├── main.py                     # Главный файл для запуска приложения
├── config.py                   # Загрузка конфигурации
├── database/
│   ├── __init__.py             # Позволяет использовать папку как модуль
│   ├── db_connection.py         # Подключение к базам данных
│   ├── db_operations.py         # Операции с базами данных (запросы, вставки и т.д.)
│   └── db_schema.py             # Определение схемы баз данных (создание таблиц и т.д.)
│
├── export/
│   ├── __init__.py
│   ├── csv_export.py            # Экспорт данных в CSV
│   └── report_export.py         # Экспорт отчетов
│
├── import/
│   ├── __init__.py
│   ├── csv_import.py            # Импорт данных из CSV
│   └── data_loader.py           # Загрузка данных в базу
│
├── monitoring/
│   ├── __init__.py
│   ├── checks.py                # Проверки качества данных
│   └── results.py               # Хранение и обработка результатов проверок
│
├── utils/
│   ├── __init__.py
│   ├── logger.py                # Настройка логирования
│   └── file_utils.py            # Утилиты для работы с файлами
│
└── requirements.txt             # Зависимости проекта
```

## Этапы проекта

1. **Выгрузка данных из мастер-системы**
   - **Описание**: На этом этапе осуществляется выгрузка данных о лицевых счетах из базы мастер-системы, которая работает на платформе Greenplum. Выгружаются два массива данных: один для открытых лицевых счетов, другой — для закрытых.
   - **Технологии**: Используется команда `COPY` с методом `copy_expert` для эффективной выгрузки данных.

2. **Загрузка данных в систему мониторинга**
   - **Описание**: Выгруженные массивы данных загружаются в базу данных системы мониторинга, которая работает на PostgreSQL. Это позволяет централизовать данные для дальнейшей обработки и анализа.
   - **Технологии**: Используется команда `COPY` с методом `copy_expert` для загрузки данных в PostgreSQL.

3. **Извлечение идентификаторов из базы мониторинга**
   - **Описание**: Из базы данных системы мониторинга извлекаются идентификаторы лицевых счетов и сохраняются в CSV-файлы. Эти идентификаторы будут использоваться для проверки состояния лицевых счетов в исторической системе.
   - **Технологии**: Используется SQL-запрос для извлечения данных и сохранения их в формате CSV.

4. **Загрузка идентификаторов в историческую систему**
   - **Описание**: Полученные на предыдущем этапе CSV-файлы с идентификаторами загружаются в базу исторической системы, которая работает на платформе Netezza. Это позволяет извлечь актуальное состояние лицевых счетов.
   - **Технологии**: Используется команда `COPY` для загрузки данных в Netezza.

5. **Выгрузка данных из исторической системы**
   - **Описание**: На этом этапе осуществляется выгрузка данных о состоянии лицевых счетов из исторической системы. Это позволяет получить информацию о текущем статусе лицевых счетов.
   - **Технологии**: Используется команда `COPY` для выгрузки данных из Netezza.

6. **Загрузка данных в систему мониторинга**
   - **Описание**: Полученные данные о состоянии лицевых счетов загружаются обратно в базу данных системы мониторинга. Это позволяет обновить информацию о лицевых счетах в системе мониторинга.
   - **Технологии**: Используется команда `COPY` для загрузки данных в PostgreSQL.

7. **Проведение проверок и формирование отчета**
   - **Описание**: На последнем этапе проводятся проверки данных между мастер-системой и исторической системой. Формируются отчеты, которые содержат результаты проверок, включая количество найденных несоответствий и другие важные метрики.
   - **Технологии**: Используются SQL-запросы для проверки данных и генерации отчетов в формате CSV и текстовых файлов.

## Заключение
Проект мониторинга качества данных состояния лицевых счетов обеспечивает надежный механизм для проверки и актуализации данных между мастер-системой и исторической системой. Реализованные этапы позволяют эффективно управлять данными и обеспечивать их целостность.